---
title: 图解HTTP
category: 笔记
tag:
  - 读书笔记
comment: false
---
# 了解web及网络基础
通常使用的网络（包括互联网）是在 TCP/IP 协议族的基础上运作 的。而 HTTP 属于它内部的一个子集。

## TCP/IP的分层
主要分为四层，从下向上依次为：数据链路层，网络层，传输层，应用层

### 数据链路层
用来处理连接网络的硬件部分。包括控制操作系统、硬件的设备驱 动、NIC（Network Interface Card，网络适配器，即网卡），及光纤等 物理可见部分（还包括连接器等一切传输媒介）。硬件上的范畴均在 链路层的作用范围之内。

### 网络层
网络层用来处理在网络上流动的数据包。数据包是网络传输的最小数 据单位。该层规定了通过怎样的路径（所谓的传输路线）到达对方计 算机，并把数据包传送给对方。 与对方计算机之间通过多台计算机或网络设备进行传输时，网络层所 起的作用就是在众多的选项内选择一条传输路线。

### 传输层
提供网络连接中的两台计算机数据传输，传输层协议有TCP和UDP

### 应用层
决定了向用户提供应用服务时通信的活动，可以理解为客户端。

## TCP/IP通信流程
![](http://image.followmyheart.cn/%E9%80%9A%E4%BF%A1%E6%B5%81%E7%A8%8B.jpg)

- （应用层）客户端DNS解析获取IP地址携带HTTP报文并发起HTTP请求
- （传输层）传输层通过三次握手建立TCP连接并增加TCP首部，注：HTTP/1.1默认使用keep-alive减少TCP连接次数
- （网络层）增加IP地址所配对的MAC地址同时增加IP首部传递给链路层
- （数据链路层）数据链路层对封装好的报文进行传输

接收方接收到以后从下向上依次进行拆包处理数据没处理一层则去掉对应首部。

## IP协议
IP 协议的作用是把各种数据包传送给对方。而要保证确实传送到对方 那里，则需要满足各类条件。其中两个重要的条件是 IP 地址和 MAC 地址（Media Access Control Address）。 IP 地址指明了节点被分配到的地址，MAC 地址是指网卡所属的固定 地址。IP 地址可以和 MAC 地址进行配对。IP 地址可变换，但 MAC 地址基本上不会更改。MAC地址的获取方式：IP地址经过ARP（Address Resolution Protocol）协议解析

## TCP协议
按层次分，TCP 位于传输层，提供可靠的字节流服务。

所谓的字节流服务（Byte Stream Service）是指，为了方便传输，将大 块数据分割成以报文段（segment）为单位的数据包进行管理。而可 靠的传输服务是指，能够把数据准确**可靠地**传给对方。一言以蔽之， TCP 协议为了更容易传送大数据才把数据分割，而且 TCP 协议能够 确认数据最终是否送达到对方

TCP与UDP的区别是TCP传输会对拆分的数据包增加序号，接收端在接收时可根据序号重组，同时提供失败重传机制；使用UDP可能会存在各种因素会导致数据包出错，虽然 UDP 可以校验数据是否正确，但是对于错误的数据包，UDP 并不提供重发机制，只是丢弃当前的包，而且 UDP 在发送之后也无法知道是否能达到目的地。

## DNS（Domain Name System）服务
DNS 协议提供通过域名 查找 IP 地址，或逆向从 IP 地址反查域名的服务。

## URI/URL的区别
**URI（Uniform Resource Identifier）**：统一资源**标识符**，例如：http://test.dev.com/index.html

**URL（Uniform Resource Locator）**：统一资源**定位符**，例如：http://test.dev.com/

通过翻译可以知道URI和资源有关，URL和路径有关

# 简单的HTTP协议
HTTP协议被用来作为客户端和服务器端的通信，并且它是一种无状态的协议，因为服务器端保存状态会出现占用大量内存的问题，因此引入了**cookie**。

## HTTP请求方法

### GET
get方法用来从服务器端获取资源
### POST
post方法用来传输实体主体
### PUT
put方法主要用来传输文件，但是put方法不提供验证机制，所以存在任何人都可以上传的问题，因此在开发中要尽量避免PUT方法的使用。若配合 Web 应用程序的验证机制，或架构设计采用 REST（REpresentational State Transfer，表征状态转移）标准的同类 Web 网站，就可能会开放使用 PUT 方法。
### DELETE
delete方法用来删除文件，缺点同上，要尽量避免使用。
### OPTIONS
用来获取服务端支持的http请求方法并返回，非简单请求会触发，简单请求包括get、post、head
### HEAD
用来获取服务端响应头

# HTTP状态
- **2xx** 服务端成功响应
- **3xx** 服务端重定向
- **4xx** 客户端情求失败
- **5xx** 服务端异常

## 2xx
### 200 服务端成功响应并返回数据

### 204 No content
该状态码代表服务器接收的请求已成功处理，但在返回的响应报文中 不含实体的主体部分。另外，也不允许返回任何实体的主体。
### 206 Partial Content
返回部分内容，当我们在请求头设置range时，设置range表示发起固定字节范围情求。

## 3xx

### 301
表示永久重定向，可以理解为我们当前情求的资源地址已永久重定向到了某一地址，与资源地址有关
### 302
表示临时重定向，当我们向服务端情求，服务端发起向其他路由重定向时会返回302，需要注意的是重定向的前提是要发起get情求，否则无法进行重定向操作。
### 304
该状态码表示客户端发送采用 GET方法的请求报文中包含 If-Match，If-Modified- Since，If-None-Match，If-Range，If-Unmodified-Since 中任一首部时，服务器端允许请求访问资源，但未满足条件的情况。304 状态码返回时，不包含任何响应 的主体部分。304 虽然被划分在 3XX 类别中，但是和重定向没有关系。

## 4xx

### 400
该状态码表示请求报文中存在语法错误。当错误发生时，需修改请求 的内容后再次发送请求。另外，浏览器会像 200 OK 一样对待该状态码。
### 401
### 403
### 404

## 5xx
### 500
### 503
该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法 处理请求。如果事先得知解除以上状况需要的时间，最好写入 RetryAfter 首部字段再返回给客户端。